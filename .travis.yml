language: node_js
node_js:
    - "0.10"
env:
    - TYPE="phpunit"
      BEFORE_GLOBAL="sudo ./bin/travis/setupphp.sh"
      BEFORE_LOCAL="./bin/travis/composer.sh"
      BEFORE_TEST="pwd"
      TEST_CMD="./vendor/phpunit/phpunit/phpunit -c phpunit.xml"
    - TYPE="behat"
      BEFORE_GLOBAL="./bin/travis/prepare_behat.sh"
      BEFORE_LOCAL="pwd"
      BEFORE_TEST="cd $HOME/build/ezplatform"
      TEST_CMD="php bin/behat -vv --profile platformui --tags common"
    - TYPE="js-tests"
      BEFORE_GLOBAL="npm install -g grunt-cli grover bower"
      BEFORE_LOCAL="./bin/travis/localjsdeps.sh"
      BEFORE_TEST="pwd"
      TEST_CMD="grunt test"

# test only master (+ Pull requests)
branches:
    only:
        - master

before_script:
    - $BEFORE_GLOBAL
    - $BEFORE_LOCAL

script:
    - $BEFORE_TEST
    - $TEST_CMD
